# æ‚…ä¾†å®¢æ£§ - éŠæˆ²ç³»çµ±è¨­è¨ˆ

> **æ–‡æª”ç‰ˆæœ¬**: v2.0
> **æœ€å¾Œæ›´æ–°**: 2025-10-28
> **éŠæˆ²ç‰ˆæœ¬**: v0.1.0

## ğŸ“‹ æ–‡æª”èªªæ˜

æœ¬æ–‡æª”æ˜¯**éŠæˆ²ç³»çµ±è¨­è¨ˆçš„æ¬Šå¨æ–‡æª”**ï¼Œè©³ç´°æè¿°æ‰€æœ‰éŠæˆ²ç³»çµ±çš„è¨­è¨ˆã€æ•¸å€¼ã€äº¤äº’å’Œå¯¦ä½œç´°ç¯€ã€‚

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šéŠæˆ²æ ¸å¿ƒæ¦‚å¿µ

### 1.1 éŠæˆ²å®šä½

**é¡å‹**: æ¡Œé¢å¯µç‰© + æ›æ©Ÿç¶“ç‡Ÿ + è¦–è¦ºå°èªª
**ç¾è¡“é¢¨æ ¼**: 32-bit åƒç´ é¢¨æ ¼ï¼ˆå…¨éŠæˆ²çµ±ä¸€ï¼‰
**ä¸»é¡Œ**: å®‹æœæ­¦ä¿ å®¢æ£§ç¶“ç‡Ÿæ¨¡æ“¬

### 1.2 é›™æ¨¡å¼è¨­è¨ˆ

#### å°è¦–çª—æ¨¡å¼ï¼ˆ300x400ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  â”‚
â”‚   [å®¢æ£§å¤–è§€]      â”‚  â† 2.5D æ–œå‘è¦–è§’
â”‚    ğŸ®æ‚…ä¾†å®¢æ£§     â”‚     æœƒéš¨é€²åº¦è®ŠåŒ–
â”‚                  â”‚
â”‚   [é–€å£æœ‰ç²¾éˆ]    â”‚
â”‚                  â”‚
â”‚ ğŸ’° 1,234  ğŸ“ˆ45/ç§’â”‚
â”‚ â° åˆæ™‚ (æ™´)     â”‚  â† æ™‚é–“é¡¯ç¤º
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å±•é–‹æ¨¡å¼ï¼ˆ900x650ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ® æ‚…ä¾†å®¢æ£§ - ä¸€æ¨“å¤§å»³  â° åˆæ™‚ä¸‰åˆ» (æ™´) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚         [2.5D å®¢æ£§å…§éƒ¨å ´æ™¯]             â”‚
â”‚                                        â”‚
â”‚   ğŸ‘” æŒæ«ƒ (æ«ƒå°)    [æ¨“æ¢¯]             â”‚
â”‚                                        â”‚
â”‚   ğŸ‘¨â€ğŸ³ å»šå¸« â†’ å»šæˆ¿   [æ¡Œå­] ğŸ‘¨â€ğŸ’¼æœå‹™å“¡  â”‚
â”‚                                        â”‚
â”‚   ğŸ’‚ ä¿é¢ (ç«™å´—)    [é–€]               â”‚
â”‚                                        â”‚
â”‚ [å»šæˆ¿] [å®¢æˆ¿] [å¾Œé™¢]  â† å ´æ™¯åˆ‡æ›       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 éŠæˆ²æµç¨‹

```
é–‹å ´æ•…äº‹ï¼ˆè¦–è¦ºå°èªªï¼‰
    â†“
å°ä»‹é¢ï¼ˆå®¢æ£§å¤–è§€ï¼‰â†’ é»æ“Šå±•é–‹
    â†“
å¤§ä»‹é¢ï¼ˆå®¢æ£§å…§éƒ¨ï¼‰
    â”œâ”€â”€ å ´æ™¯åˆ‡æ›ï¼ˆå¤§å»³ã€å»šæˆ¿ã€å„²è—å®¤ã€å®¢æˆ¿ç­‰ï¼‰
    â”œâ”€â”€ è§’è‰²ç®¡ç†ï¼ˆé›‡ç”¨ã€é…ç½®ã€è¨“ç·´ï¼‰
    â”œâ”€â”€ è¨­æ–½å‡ç´šï¼ˆç§‘æŠ€æ¨¹ï¼‰
    â”œâ”€â”€ äº‹ä»¶è™•ç†ï¼ˆåŠ‡æƒ…ã€éš¨æ©Ÿï¼‰
    â””â”€â”€ æ´¾é£ä»»å‹™ï¼ˆæŠ¼æ¨™ã€è¡Œå•†ï¼‰
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šæ ¸å¿ƒç³»çµ±åˆ—è¡¨

### 2.1 ç³»çµ±æ¸…å–®

| ç³»çµ± | ç‹€æ…‹ | å„ªå…ˆç´š | èªªæ˜ |
|------|------|--------|------|
| æ™‚é–“ç³»çµ± (TimeManager) | âœ… å®Œæˆ | P0 | æ™‚é–“æµé€Ÿã€ç‡Ÿæ¥­æ™‚é–“ |
| ç¶“ç‡Ÿç³»çµ± (InnManager) | âœ… å®Œæˆ | P0 | å®¢æ£§ç®¡ç†ã€æ”¶æ”¯ |
| å“¡å·¥ç³»çµ± (CharacterDispatchManager) | âœ… å®Œæˆ | P0 | è§’è‰²èª¿åº¦ã€å·¥ä½œåˆ†é… |
| çƒ¹é£ªç³»çµ± (RecipeManager) | âœ… å®Œæˆ | P0 | èœè­œã€é£Ÿæã€å“è³ª |
| å¥½æ„Ÿåº¦ç³»çµ± (AffectionManager) | âœ… å®Œæˆ | P1 | è§’è‰²é—œä¿‚ã€å¥½æ„Ÿåº¦ |
| åŠ‡æƒ…ç³»çµ± (StoryManager) | âœ… å®Œæˆ | P1 | è¦–è¦ºå°èªªã€åˆ†æ”¯åŠ‡æƒ… |
| äº‹ä»¶ç³»çµ± (EventManager) | âœ… å®Œæˆ | P1 | éš¨æ©Ÿäº‹ä»¶ã€è§¸ç™¼æ¢ä»¶ |
| å­¸ç¿’ç³»çµ± (LearningManager) | âœ… å®Œæˆ | P1 | è®€æ›¸ã€æ‹œå¸«ã€æŠ€èƒ½ |
| æˆ°é¬¥ç³»çµ± (CombatManager) | ğŸš§ é€²è¡Œä¸­ | P2 | å›åˆåˆ¶æˆ°é¬¥ |
| è²¿æ˜“ç³»çµ± (TradeManager) | â³ å¾…å¯¦ä½œ | P2 | å•†å“äº¤æ˜“ã€å¸‚å ´ |
| æ´¾é£ç³»çµ± (MissionManager) | â³ å¾…å¯¦ä½œ | P2 | æŠ¼æ¨™ã€è¡Œå•†ã€æ¢ç´¢ |
| ç§‘æŠ€æ¨¹ç³»çµ± (TechnologyManager) | â³ å¾…å¯¦ä½œ | P3 | å»ºç¯‰å‡ç´šã€ç ”ç™¼ |
| å­£ç¯€ç³»çµ± (SeasonManager) | â³ å¾…å¯¦ä½œ | P3 | å­£ç¯€è®ŠåŒ–ã€æ°£å€™ |
| æˆå°±ç³»çµ± (AchievementManager) | â³ å¾…å¯¦ä½œ | P3 | æˆå°±è¨˜éŒ„ |

### 2.2 ç³»çµ±ä¾è³´é—œä¿‚åœ–

```
GameState (æ ¸å¿ƒç‹€æ…‹ç®¡ç†)
  â”œâ”€ TimeManager (æ™‚é–“é©…å‹•å™¨)
  â”‚   â””â”€ triggers â†’ æ‰€æœ‰ç³»çµ±çš„ update()
  â”‚
  â”œâ”€ ç¶“ç‡Ÿå±¤
  â”‚   â”œâ”€ InnManager (å®¢æ£§ç®¡ç†)
  â”‚   â”‚   â”œâ”€ CharacterDispatchManager (å“¡å·¥èª¿åº¦)
  â”‚   â”‚   â”œâ”€ RecipeManager (çƒ¹é£ªç³»çµ±)
  â”‚   â”‚   â””â”€ GuestManager (å®¢äººç®¡ç†)
  â”‚   â””â”€ TechnologyManager (ç§‘æŠ€æ¨¹)
  â”‚
  â”œâ”€ åŠ‡æƒ…å±¤
  â”‚   â”œâ”€ StoryManager (åŠ‡æƒ…æ§åˆ¶)
  â”‚   â”œâ”€ EventManager (äº‹ä»¶è§¸ç™¼)
  â”‚   â””â”€ AffectionManager (å¥½æ„Ÿåº¦)
  â”‚
  â”œâ”€ æ´»å‹•å±¤
  â”‚   â”œâ”€ MissionManager (æ´¾é£ä»»å‹™)
  â”‚   â”œâ”€ TradeManager (è²¿æ˜“)
  â”‚   â””â”€ CombatManager (æˆ°é¬¥)
  â”‚
  â””â”€ æŒä¹…åŒ–å±¤
      â””â”€ SaveManager (å­˜æª”)
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæ ¸å¿ƒæ•¸æ“šçµæ§‹

### 3.1 ä¸»è§’æ•¸æ“š (Player)

```javascript
{
    // åŸºæœ¬è³‡è¨Š
    name: "æœªå‘½å",           // ä¸»è§’åå­—ï¼ˆéŠæˆ²ä¸­è¨­å®šï¼‰
    age: 20,
    gender: "male",          // male/female

    // æ ¸å¿ƒå±¬æ€§ï¼ˆ0-100ï¼‰
    attributes: {
        physique: 10,        // é«”è³ªï¼ˆå½±éŸ¿ç–²å‹æ¢å¾©ã€è² é‡ï¼‰
        strength: 10,        // æ­¦åŠ›ï¼ˆå½±éŸ¿æˆ°é¬¥ã€è­·è¡›ï¼‰
        intelligence: 10,    // æ™ºæ…§ï¼ˆå½±éŸ¿å­¸ç¿’ã€ç ”ç©¶ï¼‰
        charisma: 10,        // å£æ‰ï¼ˆå½±éŸ¿è«‡åˆ¤ã€æ‹›å¾…ï¼‰
        dexterity: 10        // éˆå·§ï¼ˆå½±éŸ¿çƒ¹é£ªã€è£½ä½œï¼‰
    },

    // å€‹æ€§ç³»çµ±ï¼ˆ-100 åˆ° +100ï¼‰
    personality: {
        righteous: 0,        // æ­£ç¾© â†â†’ é‚ªæƒ¡
        benevolent: 0,       // ä»æ…ˆ â†â†’ å†·é…·
        cautious: 0,         // è¬¹æ… â†â†’ å†’éšª
        frugal: 0,           // ç¯€å„‰ â†â†’ å¥¢ä¾ˆ
        humble: 0            // è¬™éœ â†â†’ å‚²æ…¢
    },

    // ç‹€æ…‹
    status: {
        fatigue: 0,          // ç–²å‹å€¼ï¼ˆ0-100ï¼‰
        health: 100,         // å¥åº·å€¼ï¼ˆ0-100ï¼‰
        mood: 50             // å¿ƒæƒ…ï¼ˆ0-100ï¼‰
    },

    // è£å‚™
    equipment: {
        weapon: null,        // æ­¦å™¨ ID
        armor: null,         // è­·ç”² ID
        accessory: null      // é…é£¾ ID
    },

    // æŠ€èƒ½åˆ—è¡¨
    skills: [
        // { id: 'skill_001', level: 5, exp: 250 }
    ],

    // ç¶“é©—å€¼
    experience: {
        total: 0,
        level: 1,
        nextLevelExp: 100
    }
}
```

### 3.2 å“¡å·¥æ•¸æ“š (Employee)

```javascript
{
    // åŸºæœ¬è³‡è¨Š
    id: 0,
    name: "æŒæ«ƒ",
    realName: "æ²ˆé’å±±",
    type: "manager",
    portrait: "assets/portraits/manager.png",  // ç«‹ç¹ª
    avatar: "assets/avatars/manager.png",      // é ­åƒ

    // èƒŒæ™¯æ•…äº‹
    story: {
        background: "...",   // èƒŒæ™¯æ•…äº‹
        personality: "...",  // æ€§æ ¼æè¿°
        preference: "..."    // å–œå¥½
    },

    // é›‡ç”¨ç‹€æ…‹
    hired: {
        unlocked: true,      // æ˜¯å¦è§£é–
        cost: 0,             // é›‡ç”¨è²»ç”¨
        salary: 100,         // æ¯æ—¥è–ªè³‡
        joinDate: 1          // åŠ å…¥æ—¥æœŸï¼ˆéŠæˆ²å¤©æ•¸ï¼‰
    },

    // æ ¸å¿ƒå±¬æ€§ï¼ˆ0-100ï¼‰
    attributes: {
        physique: 50,
        strength: 60,
        intelligence: 70,
        charisma: 80,
        dexterity: 40
    },

    // æˆé•·ç‡ï¼ˆ1.0 = æ­£å¸¸ï¼Œè¶Šé«˜æˆé•·è¶Šå¿«ï¼‰
    growthRate: {
        physique: 1.0,
        strength: 1.2,
        intelligence: 1.5,
        charisma: 1.3,
        dexterity: 0.8
    },

    // æ‰èƒ½ï¼ˆå½±éŸ¿å·¥ä½œè¡¨ç¾å’Œæˆé•·ï¼‰
    talents: [
        {
            id: "talent_management",
            name: "å¤©ç”Ÿé ˜å°",
            description: "ç®¡ç†å·¥ä½œæ•ˆç‡+30%ï¼Œæ™ºæ…§æˆé•·+20%",
            effects: {
                workBonus: { management: 0.3 },
                growthBonus: { intelligence: 0.2 }
            }
        }
    ],

    // æŠ€èƒ½ï¼ˆä¸»å‹•/è¢«å‹•æŠ€èƒ½ï¼‰
    skills: [
        {
            id: "skill_accounting",
            name: "ç²¾æ‰“ç´°ç®—",
            type: "passive",
            level: 3,
            exp: 450,
            maxLevel: 10,
            description: "å®¢æ£§æ”¶å…¥+5%",
            effects: { incomeBonus: 0.05 }
        }
    ],

    // ç‹€æ…‹
    status: {
        fatigue: 0,          // ç–²å‹å€¼ï¼ˆ0-100ï¼‰
        health: 100,
        mood: 80,
        currentState: "IDLE" // IDLE/WORKING/RESTING/SLEEPING/MISSION
    },

    // å·¥ä½œåˆ†é…
    work: {
        assignedStation: null,       // ç•¶å‰å·¥ä½œç«™
        workHours: 0,                // ä»Šæ—¥å·¥ä½œæ™‚é•·
        efficiency: 1.0,             // å·¥ä½œæ•ˆç‡ï¼ˆå—ç–²å‹å½±éŸ¿ï¼‰
        experience: 0                // å·¥ä½œç¶“é©—
    },

    // è£å‚™
    equipment: {
        weapon: null,
        armor: null,
        accessory: null
    },

    // å¥½æ„Ÿåº¦ç³»çµ±
    affection: {
        level: 0,            // å¥½æ„Ÿåº¦ç­‰ç´šï¼ˆ0-100ï¼‰
        points: 0,           // å¥½æ„Ÿåº¦é»æ•¸
        relationship: "stranger",  // stranger/acquaintance/friend/close_friend/lover

        // å¥½æ„Ÿåº¦æ­·å²äº‹ä»¶
        events: [
            // { type: "gift", value: +5, date: 10, description: "æ”¶åˆ°ç¦®ç‰©å¾ˆé–‹å¿ƒ" }
        ]
    },

    // ä½ç½®ï¼ˆ2Då ´æ™¯ï¼‰
    position: {
        scene: "lobby",      // ç•¶å‰å ´æ™¯
        x: 220,
        y: 130
    }
}
```

### 3.3 æ™‚é–“ç³»çµ±æ•¸æ“š (Time)

```javascript
{
    // ç•¶å‰æ™‚é–“
    current: {
        year: 1,             // å¹´ä»½
        month: 1,            // æœˆä»½ (1-12)
        day: 1,              // æ—¥æœŸ (1-30)
        dayCount: 1,         // ç¸½å¤©æ•¸
        hour: 8,             // æ™‚åˆ» (0-23)
        minute: 0,           // åˆ†é˜ (0-59)
        season: "æ˜¥",        // æ˜¥/å¤/ç§‹/å†¬
        weather: "æ™´"        // æ™´/é™°/é›¨/é›ª
    },

    // æ™‚é–“æµé€Ÿ
    timeScale: 1.0,          // å€é€Ÿï¼ˆå¯èª¿æ•´ï¼‰

    // ç‡Ÿæ¥­æ™‚é–“
    businessHours: {
        open: 6,             // 06:00 é–‹é–€
        close: 22            // 22:00 é—œé–€
    },

    // ç‰¹æ®Šæ—¥æœŸï¼ˆç¯€æ—¥ã€äº‹ä»¶æ—¥ï¼‰
    specialDays: [
        {
            dayIndex: 15,    // æ¯æœˆ15æ—¥
            type: "festival",
            name: "ä¸­ç§‹ç¯€",
            effects: {
                customerBonus: 1.5,
                eventChance: 0.3
            }
        }
    ]
}
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šå ´æ™¯å¼ç¶“ç‡Ÿç³»çµ±

### 4.1 å ´æ™¯ç³»çµ±è¨­è¨ˆç†å¿µ

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š
- å°‡å®¢æ£§åˆ†æˆå¤šå€‹åŠŸèƒ½å ´æ™¯
- æ¯å€‹å ´æ™¯æœ‰ç¨ç‰¹çš„ç¶“ç‡Ÿç©æ³•
- å ´æ™¯é–“ç›¸äº’é—œè¯ï¼Œå½¢æˆå®Œæ•´ç¶“ç‡Ÿå¾ªç’°

**å ´æ™¯åˆ—è¡¨**ï¼š
1. **å¤–è§€å ´æ™¯** (ExteriorScene) - å°è¦–çª—æ¨¡å¼
2. **å¤§å»³å ´æ™¯** (LobbyScene) - æ¥å¾…å®¢äºº
3. **å»šæˆ¿å ´æ™¯** (KitchenScene) - çƒ¹é£ªæ–™ç†
4. **å®¢æˆ¿å ´æ™¯** (RoomScene) - å®¢æˆ¿ç®¡ç†
5. **å„²è—å®¤å ´æ™¯** (StorageScene) - ç‰©è³‡ç®¡ç†
6. **åº­é™¢å ´æ™¯** (YardScene) - ä¼‘é–’å¨›æ¨‚

### 4.2 å ´æ™¯åˆ‡æ›é‚è¼¯

```
å¤–è§€å ´æ™¯ (ExteriorScene)
  â†“ é»æ“Šå¤§é–€
å¤§å»³å ´æ™¯ (LobbyScene)
  â”œâ†’ é»æ“Šæ«ƒå° â†’ ç®¡ç†ä»‹é¢
  â”œâ†’ é»æ“Šå»šæˆ¿é–€ â†’ å»šæˆ¿å ´æ™¯ (KitchenScene)
  â”œâ†’ é»æ“Šå„²è—å®¤é–€ â†’ å„²è—å®¤å ´æ™¯ (StorageScene)
  â”œâ†’ é»æ“Šå®¢æˆ¿Aé–€ â†’ å®¢æˆ¿Aå ´æ™¯ (RoomAScene)
  â””â†’ é»æ“Šå®¢æˆ¿Bé–€ â†’ å®¢æˆ¿Bå ´æ™¯ (RoomBScene)
```

### 4.3 å¤§å»³å ´æ™¯ï¼ˆè©³ç´°è¨­è¨ˆï¼‰

**åŠŸèƒ½**ï¼š
- æ¥å¾…å®¢äºº
- å®¢äººé»é¤
- æœå‹™è©•åˆ†
- è²æœ›ç©ç´¯

**UIå¸ƒå±€**ï¼š
```
[é ‚éƒ¨ç‹€æ…‹æ¬„ï¼šæ™‚é–“ | é‡‘éŒ¢ | è²æœ›]
[ä¸­å¤®å€åŸŸï¼šå®¢äººåº§ä½ï¼ˆ8å€‹ï¼‰]
[å·¦å´ï¼šå¾…æ¥å¾…å®¢äººéšŠåˆ—]
[å³å´ï¼šç•¶å‰è¨‚å–®åˆ—è¡¨]
[åº•éƒ¨ï¼šå“¡å·¥å¿«æ·æ“ä½œ]
```

**ç©æ³•æµç¨‹**ï¼š
1. å®¢äººåˆ°é” â†’ æ’éšŠç­‰å¾…
2. æŒ‡æ´¾å“¡å·¥æ¥å¾… â†’ å®¢äººå…¥åº§
3. å®¢äººé»é¤ â†’ ç”Ÿæˆè¨‚å–®
4. å»šæˆ¿è£½ä½œ â†’ å®Œæˆæ–™ç†
5. æŒ‡æ´¾å“¡å·¥ä¸Šèœ â†’ å®¢äººç”¨é¤
6. å®¢äººçµå¸³ â†’ ç²å¾—æ”¶å…¥ + è©•åƒ¹

**æ•¸å€¼è¨­è¨ˆ**ï¼š
- ç­‰å¾…å®¹å¿åº¦ï¼š60ç§’ï¼ˆè¶…éé–‹å§‹ä¸æ»¿ï¼‰
- æœå‹™è©•åˆ†ï¼š1-5æ˜Ÿï¼ˆå½±éŸ¿è²æœ›å’Œå°è²»ï¼‰
- åº§ä½ä¸Šé™ï¼š8å€‹ï¼ˆå¯å‡ç´šåˆ°12å€‹ï¼‰

### 4.4 å»šæˆ¿å ´æ™¯ï¼ˆè©³ç´°è¨­è¨ˆï¼‰

**åŠŸèƒ½**ï¼š
- çƒ¹é£ªæ–™ç†
- é£Ÿæç®¡ç†
- é…æ–¹ç ”ç™¼

**å·¥ä½œç«™**ï¼š
```javascript
const KITCHEN_STATIONS = {
    stove: {
        name: "çˆç¶",
        maxWorkers: 2,
        requiredSkill: "cooking",
        efficiency: 1.0
    },
    prep_table: {
        name: "å‚™èœå°",
        maxWorkers: 1,
        requiredSkill: "dexterity",
        efficiency: 0.8
    }
};
```

**çƒ¹é£ªæµç¨‹**ï¼š
1. æ¥æ”¶è¨‚å–®
2. æª¢æŸ¥é£Ÿæ
3. æŒ‡æ´¾å»šå¸«
4. é–‹å§‹çƒ¹é£ª
5. å“è³ªåˆ¤å®š
6. å®Œæˆå‡ºé¤

### 4.5 å„²è—å®¤å ´æ™¯

**åŠŸèƒ½**ï¼š
- ç‰©å“å„²å­˜
- åº«å­˜ç®¡ç†
- é£Ÿæä¿é®®

**å€‰åº«å®¹é‡**ï¼š
- åˆå§‹å®¹é‡ï¼š50æ ¼
- å¯å‡ç´šåˆ°ï¼š100æ ¼ã€150æ ¼ã€200æ ¼

**ä¿é®®ç³»çµ±**ï¼š
- æ¯ç¨®é£Ÿææœ‰ä¿é®®æœŸï¼ˆ3-30å¤©ï¼‰
- è¶…éä¿é®®æœŸå“è³ªä¸‹é™
- å†°çª–å‡ç´šå¯å»¶é•·ä¿é®®æœŸ

### 4.6 å®¢æˆ¿å ´æ™¯

**åŠŸèƒ½**ï¼š
- å®¢äººä½å®¿
- æˆ¿é–“å‡ç´š
- ä½å®¿æ”¶å…¥

**æˆ¿é–“é¡å‹**ï¼š
- æ™®é€šå®¢æˆ¿ï¼ˆ5å…©/æ™šï¼‰
- ä¸­ç­‰å®¢æˆ¿ï¼ˆ10å…©/æ™šï¼‰
- è±ªè¯å¥—æˆ¿ï¼ˆ20å…©/æ™šï¼‰

### 4.7 åº­é™¢å ´æ™¯

**åŠŸèƒ½**ï¼š
- å“¡å·¥ä¼‘æ¯
- è¨“ç·´å ´åœ°
- ç¨®æ¤æ¡é›†

**æ´»å‹•å€åŸŸ**ï¼š
- ä¼‘æ¯å€ï¼šæ¢å¾©ç–²å‹
- è¨“ç·´å ´ï¼šæå‡å±¬æ€§
- èœåœ’ï¼šç¨®æ¤é£Ÿæ

---

## ç¬¬äº”éƒ¨åˆ†ï¼šæ™‚é–“ç³»çµ±

### 5.1 æ™‚é–“æµé€Ÿ

- **éŠæˆ²å…§ 1å¤© = ç¾å¯¦æ™‚é–“ 30åˆ†é˜**ï¼ˆå¯èª¿æ•´å€é€Ÿï¼‰
- **éŠæˆ²å…§ 1æœˆ = 30å¤©**
- **éŠæˆ²å…§ 1å¹´ = 12å€‹æœˆ**

### 5.2 æ™‚æ®µåŠƒåˆ†

| æ™‚æ®µ | éŠæˆ²æ™‚é–“ | èªªæ˜ | å®¢æµé‡ |
|------|---------|------|--------|
| å‡Œæ™¨ | 00:00-06:00 | ä¼‘æ¯æ™‚æ®µ | ç„¡å®¢äºº |
| æ¸…æ™¨ | 06:00-09:00 | æº–å‚™ç‡Ÿæ¥­ | ç¨€å°‘ |
| ä¸Šåˆ | 09:00-12:00 | å®¢äººé«˜å³° | ä¸­ç­‰ |
| ä¸­åˆ | 12:00-14:00 | åˆé¤æ™‚æ®µ | é«˜å³° |
| ä¸‹åˆ | 14:00-18:00 | åˆä¼‘æ™‚æ®µ | ç¨€å°‘ |
| å‚æ™š | 18:00-20:00 | æ™šé¤æ™‚æ®µ | é«˜å³° |
| å¤œæ™š | 20:00-22:00 | æ”¶å°¾æ™‚æ®µ | ä¸­ç­‰ |
| æ·±å¤œ | 22:00-24:00 | æ‰“çƒŠ | ç„¡å®¢äºº |

### 5.3 æ™‚é–“äº‹ä»¶

**æ¯æ—¥äº‹ä»¶**ï¼š
- 06:00ï¼šæ–°çš„ä¸€å¤©é–‹å§‹
- 06:00ï¼šå“¡å·¥ä¸Šç­
- 22:00ï¼šå®¢æ£§æ‰“çƒŠ
- 22:00ï¼šæ¯æ—¥çµç®—
- 00:00ï¼šå“¡å·¥ä¼‘æ¯

**æ¯æœˆäº‹ä»¶**ï¼š
- 30æ—¥ï¼šæœˆçµç®—
- 30æ—¥ï¼šæ”¯ä»˜è–ªè³‡
- 30æ—¥ï¼šè¨­æ–½ç¶­è­·

**ç‰¹å®šæ—¥æœŸäº‹ä»¶**ï¼š
- ç¯€æ—¥äº‹ä»¶
- åŠ‡æƒ…è§¸ç™¼
- ç‰¹æ®Šå®¢äººåˆ°è¨ª

### 5.4 å¯¦ä½œæ¥å£

```javascript
class TimeManager {
    update(deltaTime)  // æ¯å¹€æ›´æ–°
    getCurrentTime()   // ç²å–ç•¶å‰æ™‚é–“
    advanceTime(hours) // å¿«é€²æ™‚é–“
    pauseTime()        // æš«åœæ™‚é–“
    setTimeScale(scale) // è¨­å®šæ™‚é–“å€é€Ÿ

    // äº‹ä»¶ç›£è½
    onDayStart(callback)   // æ–°ä¸€å¤©äº‹ä»¶
    onMonthEnd(callback)   // æœˆçµç®—äº‹ä»¶
    onHourChange(callback) // æ¯å°æ™‚äº‹ä»¶
}
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šç¶“ç‡Ÿç³»çµ±

### 6.1 å®¢æ£§å±¬æ€§

```javascript
{
    name: "æ‚…ä¾†å®¢æ£§",
    gold: 1000,           // é‡‘éŒ¢
    reputation: 0,        // è²æœ›ï¼ˆ0-100ï¼‰
    satisfaction: 50,     // å®¢äººæ»¿æ„åº¦ï¼ˆ0-100ï¼‰
    capacity: 8,          // åº§ä½æ•¸

    // è¨­æ–½ç­‰ç´š
    facilities: {
        lobby: 1,         // å¤§å»³ï¼ˆ1-3ç´šï¼‰
        kitchen: 1,       // å»šæˆ¿ï¼ˆ1-3ç´šï¼‰
        storage: 1,       // å€‰åº«ï¼ˆ1-3ç´šï¼‰
        room_a: 1,        // å®¢æˆ¿Aï¼ˆ1-3ç´šï¼‰
        room_b: 0,        // å®¢æˆ¿Bï¼ˆ0-3ç´šï¼Œæœªè§£é–ï¼‰
        yard: 0           // åº­é™¢ï¼ˆ0-2ç´šï¼Œå¯é¸ï¼‰
    }
}
```

### 6.2 æ”¶å…¥ä¾†æº

1. **å®¢äººæ¶ˆè²»**ï¼šåŸºç¤æ”¶å…¥
   - æ–™ç†æ”¶å…¥
   - ä½å®¿æ”¶å…¥
   - å°è²»æ”¶å…¥

2. **ç‰¹æ®Šè¨‚å–®**ï¼šé«˜åˆ©æ½¤è¨‚å–®
   - å®´å¸­è¨‚å–®ï¼ˆ+500å…©ï¼‰
   - VIPå®¢äººï¼ˆ+200å…©ï¼‰

3. **è²¿æ˜“æ”¶å…¥**ï¼šè³£å‡ºç‰©å“
   - é£Ÿæè²©è³£
   - è£å‚™è²©è³£

4. **ä»»å‹™çå‹µ**ï¼šå®Œæˆä»»å‹™
   - æŠ¼æ¨™ä»»å‹™ï¼ˆ+300å…©ï¼‰
   - è¡Œå•†ä»»å‹™ï¼ˆ+200å…©ï¼‰

### 6.3 æ”¯å‡ºé …ç›®

1. **å“¡å·¥è–ªè³‡**ï¼šæ¯æœˆå›ºå®šæ”¯å‡º
   - æŒæ«ƒï¼š100å…©/æœˆ
   - å»šå¸«ï¼š80å…©/æœˆ
   - æœå‹™å“¡ï¼š60å…©/æœˆ
   - å…¶ä»–å“¡å·¥ï¼š40-80å…©/æœˆ

2. **é£Ÿææ¡è³¼**ï¼šçƒ¹é£ªæˆæœ¬
   - æ ¹æ“šèœå–®èª¿æ•´
   - å­£ç¯€æ€§åƒ¹æ ¼æ³¢å‹•

3. **è¨­æ–½ç¶­è­·**ï¼šæ¯æœˆå›ºå®šæ”¯å‡º
   - åŸºç¤ç¶­è­·ï¼š50å…©/æœˆ
   - é«˜ç´šè¨­æ–½ï¼š+20å…©/æœˆ/ç´š

4. **è¨­æ–½å‡ç´š**ï¼šä¸€æ¬¡æ€§å¤§é¡æ”¯å‡º
   - å¤§å»³å‡ç´šï¼š500å…©
   - å»šæˆ¿å‡ç´šï¼š400å…©
   - å€‰åº«å‡ç´šï¼š300å…©
   - å®¢æˆ¿å‡ç´šï¼š600å…©

### 6.4 æ•¸å€¼å¹³è¡¡

**ç¬¬1å¹´ç›®æ¨™**ï¼šç”Ÿå­˜æœŸï¼ˆå‹‰å¼·ç›ˆåˆ©ï¼‰
- æœˆæ”¶å…¥ï¼šâ‰¥ 200å…©
- å¹´æ”¶å…¥ï¼šâ‰¥ 2000å…©
- å“¡å·¥æ•¸ï¼š2-3äºº

**ç¬¬2å¹´ç›®æ¨™**ï¼šæˆé•·æœŸï¼ˆç©©å®šç›ˆåˆ©ï¼‰
- æœˆæ”¶å…¥ï¼šâ‰¥ 500å…©
- å¹´æ”¶å…¥ï¼šâ‰¥ 5000å…©
- å“¡å·¥æ•¸ï¼š4-6äºº

**ç¬¬3å¹´ç›®æ¨™**ï¼šç™¼å±•æœŸï¼ˆé«˜é¡ç›ˆåˆ©ï¼‰
- æœˆæ”¶å…¥ï¼šâ‰¥ 1000å…©
- å¹´æ”¶å…¥ï¼šâ‰¥ 10000å…©
- å“¡å·¥æ•¸ï¼š7-8äºº

**ç¬¬4å¹´ç›®æ¨™**ï¼šæˆç†ŸæœŸï¼ˆè‡ªç”±ç™¼å±•ï¼‰
- æœˆæ”¶å…¥ï¼šâ‰¥ 1500å…©
- å¹´æ”¶å…¥ï¼šâ‰¥ 15000å…©
- å“¡å·¥æ•¸ï¼š9-10äºº

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå“¡å·¥ç³»çµ±

### 7.1 å·¥ä½œèª¿åº¦ç³»çµ±

#### å·¥ä½œå´—ä½å®šç¾©

```javascript
const WORK_STATIONS = {
    lobby: {
        name: "å¤§å»³æ¥å¾…",
        location: { x: 200, y: 150 },
        maxWorkers: 2,
        requiredSkills: ["service"],
        workHours: [6, 22],
        incomeBonus: 1.2
    },

    kitchen: {
        name: "å»šæˆ¿çƒ¹é£ª",
        location: { x: 100, y: 200 },
        maxWorkers: 2,
        requiredSkills: ["cooking"],
        workHours: [6, 22],
        incomeBonus: 1.5
    },

    security: {
        name: "å®‰ä¿å·¡é‚",
        location: { x: 300, y: 100 },
        maxWorkers: 1,
        requiredSkills: ["combat"],
        workHours: [6, 24],
        incomeBonus: 1.0
    },

    management: {
        name: "æ«ƒå°ç®¡ç†",
        location: { x: 200, y: 120 },
        maxWorkers: 1,
        requiredSkills: ["management"],
        workHours: [6, 22],
        incomeBonus: 1.4
    }
};
```

#### å·¥ä½œç‹€æ…‹æ©Ÿ

```javascript
å“¡å·¥ç‹€æ…‹ {
    IDLE: "é–’ç½®",      // ç„¡äº‹å¯åš
    WALKING: "ç§»å‹•ä¸­",  // å‰å¾€å·¥ä½œå´—ä½
    WORKING: "å·¥ä½œä¸­",  // æ­£åœ¨å·¥ä½œ
    RESTING: "ä¼‘æ¯ä¸­",  // å·¥ä½œé–“éš™ä¼‘æ¯
    SLEEPING: "ç¡çœ ä¸­", // æ™šä¸Šç¡è¦º
    MISSION: "ä»»å‹™ä¸­",  // å¤–å‡ºä»»å‹™
    EVENT: "äº‹ä»¶ä¸­"    // è§¸ç™¼ç‰¹æ®Šäº‹ä»¶
}
```

### 7.2 æ´¾é£ç³»çµ±

**å·¥ä½œé¡å‹**ï¼š
- çƒ¹é£ªï¼šå»šæˆ¿å·¥ä½œ
- æœå‹™ï¼šå¤§å»³æ¥å¾…
- æ¡è³¼ï¼šå¤–å‡ºæ¡è²·
- æ¸…æ½”ï¼šè¨­æ–½ç¶­è­·
- ç¶­è­·ï¼šè¨­æ–½ä¿®ç†
- å¤–å‡ºä»»å‹™ï¼šæŠ¼æ¨™ã€è¡Œå•†

**æ•ˆç‡è¨ˆç®—**ï¼š
```
å·¥ä½œæ•ˆç‡ = åŸºç¤å±¬æ€§ Ã— (1 - ç–²å‹/100) Ã— (å¿ƒç›¸/100) Ã— è·æ¥­ä¿®æ­£
```

**ç–²å‹ç´¯ç©**ï¼š
- æ¯å·¥ä½œ1å°æ™‚ +5ç–²å‹
- ç–²å‹â‰¥80æ™‚å·¥ä½œæ•ˆç‡-50%
- ç–²å‹â‰¥100æ™‚ç„¡æ³•å·¥ä½œ

**ç–²å‹æ¢å¾©**ï¼š
- ä¼‘æ¯1å°æ™‚ -10ç–²å‹
- ç¡çœ 1å°æ™‚ -20ç–²å‹
- æ³¡æ¾¡ -30ç–²å‹ï¼ˆéœ€è¦è¨­æ–½ï¼‰

### 7.3 è§’è‰²å°ˆé•·ç³»çµ±

#### 10ä½è§’è‰²å°ˆé•·å®šç¾©

| è§’è‰² | é«”è³ª | æ­¦åŠ› | æ™ºæ…§ | å£æ‰ | éˆå·§ | ä¸»è¦å·¥ä½œ |
|------|------|------|------|------|------|---------|
| æŒæ«ƒ | 50 | 60 | **80** | **85** | 45 | ç®¡ç†ã€æ¥å¾… |
| å»šå¸« | 60 | 50 | 65 | 40 | **90** | çƒ¹é£ªã€è—¥è†³ |
| æœå‹™å“¡ | 55 | 30 | 50 | **85** | 60 | æœå‹™ã€æ¥å¾… |
| ä¿é¢ | **80** | **90** | 45 | 40 | 50 | æˆ°é¬¥ã€å®‰ä¿ |
| è·‘å ‚ | **70** | 55 | 45 | 65 | 55 | è·‘è…¿ã€é›œå‹™ |
| è—¥å¸« | 50 | 40 | **85** | 45 | **80** | é†«ç™‚ã€ç…‰è—¥ |
| èªªæ›¸äºº | 45 | 40 | **80** | **90** | 50 | å¨›æ¨‚ã€æƒ…å ± |
| æ¨‚å¸« | 50 | 45 | 60 | **75** | **85** | å¨›æ¨‚ã€ç´è— |
| è³¬æˆ¿ | 40 | 30 | **90** | 60 | 55 | ç®¡ç†ã€ç®—è³¬ |
| é–€ç«¥ | 60 | 50 | 40 | **70** | 45 | è¿è³“ã€é›œå‹™ |

---

## ç¬¬å…«éƒ¨åˆ†ï¼šçƒ¹é£ªç³»çµ±

### 8.1 é£Ÿæç³»çµ±

**é£Ÿæåˆ†é¡**ï¼š
- ä¸»æ–™ï¼šç±³ã€éºµã€è‚‰ã€é­š
- é…æ–™ï¼šè”¬èœã€è›‹ã€è±†è…
- èª¿æ–™ï¼šé¹½ã€é†¬æ²¹ã€é†‹ã€ç³–

**é£Ÿæå“è³ª**ï¼š
- æ™®é€šï¼šåŸºç¤å“è³ª
- å„ªè‰¯ï¼š+10%æˆå“å“è³ª
- ç²¾å“ï¼š+20%æˆå“å“è³ª

**é£Ÿæä¿é®®**ï¼š
- è‚‰é¡ï¼š3å¤©
- è”¬èœï¼š5å¤©
- ä¹¾è²¨ï¼š30å¤©
- èª¿æ–™ï¼šæ°¸ä¹…

**é£Ÿæç²å–**ï¼š
- å¸‚å ´æ¡è³¼ï¼šåŸºæœ¬æ–¹å¼
- ä»»å‹™çå‹µï¼šç‰¹æ®Šé£Ÿæ
- åº­é™¢ç¨®æ¤ï¼šè‡ªçµ¦è‡ªè¶³ï¼ˆéœ€è§£é–ï¼‰

### 8.2 èœè­œç³»çµ±

```javascript
{
    id: 'rice_congee',
    name: 'ç™½ç²¥',
    category: 'ä¸»é£Ÿ',
    difficulty: 1,        // é›£åº¦ï¼ˆ1-5ï¼‰
    cookTime: 10,         // è£½ä½œæ™‚é–“ï¼ˆåˆ†é˜ï¼‰

    ingredients: [        // æ‰€éœ€é£Ÿæ
        { id: 'rice', quantity: 2 },
        { id: 'water', quantity: 5 }
    ],

    requiredSkill: 1,     // æ‰€éœ€çƒ¹é£ªæŠ€èƒ½
    sellPrice: 5,         // å”®åƒ¹
    reputation: 1,        // è²æœ›çå‹µ
    satisfaction: 10,     // æ»¿æ„åº¦çå‹µ

    unlockCondition: {
        level: 1,
        reputation: 0
    }
}
```

### 8.3 å“è³ªç³»çµ±

**å“è³ªç­‰ç´š**ï¼š
- å¤±æ•—ï¼ˆ0-30%ï¼‰ï¼šé€€èœ
- æ™®é€šï¼ˆ30-60%ï¼‰ï¼šåŸºç¤åƒ¹æ ¼
- å„ªè‰¯ï¼ˆ60-80%ï¼‰ï¼š1.2å€åƒ¹æ ¼
- ç²¾å“ï¼ˆ80-95%ï¼‰ï¼š1.5å€åƒ¹æ ¼
- æ¥µå“ï¼ˆ95-100%ï¼‰ï¼š2å€åƒ¹æ ¼

**å“è³ªå½±éŸ¿å› ç´ **ï¼š
1. å»šå¸«çƒ¹é£ªæŠ€èƒ½ï¼ˆä¸»è¦ï¼‰ï¼š60%æ¬Šé‡
2. é£Ÿæå“è³ªï¼ˆæ¬¡è¦ï¼‰ï¼š25%æ¬Šé‡
3. å»šæˆ¿è¨­æ–½ç­‰ç´šï¼ˆè¼”åŠ©ï¼‰ï¼š10%æ¬Šé‡
4. éš¨æ©Ÿå› ç´ ï¼ˆÂ±10%ï¼‰ï¼š5%æ¬Šé‡

**è¨ˆç®—å…¬å¼**ï¼š
```
åŸºç¤æˆåŠŸç‡ = (å»šå¸«éˆå·§ / èœè­œé›£åº¦) / 100
å“è³ªèª¿æ•´ = é£Ÿæå“è³ªåŠ æˆ + è¨­æ–½åŠ æˆ
æœ€çµ‚å“è³ª = (åŸºç¤æˆåŠŸç‡ Ã— å“è³ªèª¿æ•´) Ã— éš¨æ©Ÿ(0.9-1.1)

å“è³ªåˆ¤å®šï¼š
< 0.3 â†’ å¤±æ•—
0.3-0.6 â†’ æ™®é€š
0.6-0.8 â†’ å„ªè‰¯
0.8-0.95 â†’ ç²¾å“
> 0.95 â†’ æ¥µå“
```

---

## ç¬¬ä¹éƒ¨åˆ†ï¼šå¥½æ„Ÿåº¦ç³»çµ±

### 9.1 å¥½æ„Ÿåº¦æ©Ÿåˆ¶

**ç¯„åœ**ï¼š0-100
**åˆå§‹å€¼**ï¼š20ï¼ˆåŸºç¤ä¿¡ä»»ï¼‰

**å¢åŠ æ–¹å¼**ï¼š
1. å°è©±é¸æ“‡ï¼ˆ+1~+5ï¼‰
2. å®Œæˆå€‹äººä»»å‹™ï¼ˆ+10~+20ï¼‰
3. è´ˆé€ç¦®ç‰©ï¼ˆ+5~+15ï¼‰
4. æ´¾é£å–œæ­¡çš„å·¥ä½œï¼ˆ+1/å¤©ï¼‰
5. ç‰¹æ®Šäº‹ä»¶é¸æ“‡ï¼ˆ+5~+30ï¼‰

**æ¸›å°‘æ–¹å¼**ï¼š
1. éŒ¯èª¤çš„å°è©±é¸æ“‡ï¼ˆ-1~-5ï¼‰
2. æ´¾é£è¨å­çš„å·¥ä½œï¼ˆ-1/å¤©ï¼‰
3. å¿½è¦–å€‹äººè«‹æ±‚ï¼ˆ-5~-10ï¼‰
4. ç‰¹æ®Šäº‹ä»¶é¸æ“‡ï¼ˆ-5~-20ï¼‰
5. é•·æœŸä¸äº’å‹•ï¼ˆ-1/é€±ï¼‰

### 9.2 å¥½æ„Ÿåº¦é‡Œç¨‹ç¢‘

| å¥½æ„Ÿåº¦ | é‡Œç¨‹ç¢‘ | é—œä¿‚ | è§£é–å…§å®¹ |
|--------|--------|------|---------|
| 0-20 | é™Œç”Ÿäºº | stranger | åƒ…åŸºç¤å°è©± |
| 20-40 | èªè­˜ | acquaintance | è§£é–åŸºç¤å·¥ä½œ |
| 40-60 | ç†Ÿæ‚‰ | friend | å€‹äººæ•…äº‹ç¬¬ä¸€ç« ã€é€ç¦® |
| 60-80 | ä¿¡ä»» | close_friend | ç‰¹æ®ŠæŠ€èƒ½ã€å€‹äººæ•…äº‹ç¬¬äºŒç«  |
| 80-100 | æ‘¯å‹/æˆ€äºº | lover | æ·±åº¦å°è©±ã€å€‹äººæ•…äº‹ç¬¬ä¸‰ç« ã€ç¨ç‰¹æŠ€èƒ½ |

### 9.3 ç¦®ç‰©ç³»çµ±

**ç¦®ç‰©é¡å‹**ï¼š
- é£Ÿç‰©é¡ï¼šç³•é»ã€é…’ã€èŒ¶
- é£¾å“é¡ï¼šé«®ç°ªã€æ‰‹é²ã€ç‰ä½©
- æ›¸ç±é¡ï¼šè©©é›†ã€é†«æ›¸ã€å…µæ³•
- ç‰¹æ®Šé¡ï¼šç¨€æœ‰ç‰©å“

**è§’è‰²åå¥½**ï¼ˆç¤ºä¾‹ï¼‰ï¼š
```javascript
{
    // æŒæ«ƒåå¥½
    0: {
        favorite: ['antique_vase', 'rare_book'],  // å–œæ­¡ï¼ˆ+15ï¼‰
        like: ['tea', 'wine'],                    // æ™®é€šï¼ˆ+5ï¼‰
        dislike: ['cheap_jewelry']                // è¨å­ï¼ˆ-5ï¼‰
    },

    // å»šå¸«åå¥½
    1: {
        favorite: ['rare_spice', 'cookbook'],
        like: ['food_ingredients'],
        dislike: ['weapon']
    }
}
```

**è´ˆç¦®è¦å‰‡**ï¼š
- æ¯äººæ¯å¤©æœ€å¤š1æ¬¡
- å–œæ­¡ç¦®ç‰©ï¼š+10~+15å¥½æ„Ÿåº¦
- æ™®é€šç¦®ç‰©ï¼š+3~+5å¥½æ„Ÿåº¦
- è¨å­ç¦®ç‰©ï¼š-5~-10å¥½æ„Ÿåº¦

---

## ç¬¬åéƒ¨åˆ†ï¼šåŠ‡æƒ…ç³»çµ±

### 10.1 åŠ‡æƒ…è§¸ç™¼æ©Ÿåˆ¶

```javascript
{
    id: 'story_001_chapter1',
    triggerType: 'time',    // time/affection/quest/choice

    triggerCondition: {
        month: 1,             // ç¬¬1å€‹æœˆ
        day: 1,               // ç¬¬1å¤©
        affection: { '001': 40 },  // è§’è‰²001å¥½æ„Ÿåº¦ â‰¥ 40
        completedQuests: []   // å·²å®Œæˆçš„ä»»å‹™
    },

    scenes: [              // å ´æ™¯åˆ—è¡¨
        {
            background: 'inn_lobby_day',
            characters: ['001'],
            dialogue: [
                {
                    speaker: '001',
                    text: 'æŒæ«ƒï¼Œå®¢äººä¾†äº†ã€‚',
                    emotion: 'normal'
                }
            ]
        }
    ],

    choices: [             // é¸æ“‡åˆ†æ”¯
        {
            text: 'é¸é …A',
            effects: {
                affection: { '001': +5 },
                personality: { benevolent: +2 }
            },
            nextStoryId: 'story_001_a'
        },
        {
            text: 'é¸é …B',
            effects: {
                affection: { '001': -2 },
                personality: { cautious: +2 }
            },
            nextStoryId: 'story_001_b'
        }
    ],

    rewards: {             // å®Œæˆçå‹µ
        gold: 100,
        items: ['quest_item_001'],
        unlockEmployee: 3  // è§£é–æ–°å“¡å·¥
    }
}
```

### 10.2 åŠ‡æƒ…é¡å‹

1. **ä¸»ç·šåŠ‡æƒ…**
   - å›ºå®šæ™‚é–“è§¸ç™¼
   - æ¨é€²ä¸»è¦æ•…äº‹
   - è§£é–æ ¸å¿ƒåŠŸèƒ½

2. **æ”¯ç·šåŠ‡æƒ…**
   - å¥½æ„Ÿåº¦è§¸ç™¼
   - è§’è‰²å€‹äººæ•…äº‹
   - æ·±åŒ–è§’è‰²èƒŒæ™¯

3. **éš¨æ©Ÿäº‹ä»¶**
   - æ¯æœˆéš¨æ©Ÿè§¸ç™¼
   - å¢åŠ éŠæˆ²è®ŠåŒ–
   - ç²å¾—é¡å¤–çå‹µ

4. **ç¯€æ—¥äº‹ä»¶**
   - ç‰¹å®šæ—¥æœŸè§¸ç™¼
   - ç¯€æ…¶æ°›åœ
   - å­£ç¯€æ€§çå‹µ

### 10.3 è¦–è¦ºå°èªªå ´æ™¯

**UIå…ƒç´ **ï¼š
- èƒŒæ™¯åœ–ï¼ˆå…¨å±ï¼‰
- è§’è‰²ç«‹ç¹ªï¼ˆå·¦/ä¸­/å³ï¼‰
- å°è©±æ¡†ï¼ˆåº•éƒ¨ï¼‰
- è§’è‰²åå­—æ¡†
- é¸æ“‡æŒ‰éˆ•ï¼ˆæœ€å¤š4å€‹ï¼‰
- è‡ªå‹•æ’­æ”¾æŒ‰éˆ•
- è·³éæŒ‰éˆ•
- å­˜æª”æŒ‰éˆ•

**ç«‹ç¹ªç³»çµ±**ï¼š
- æ¯å€‹è§’è‰²5-10å€‹è¡¨æƒ…
- å¯å·¦å³ç§»å‹•
- æ”¯æŒæ·¡å…¥æ·¡å‡º
- æ”¯æŒå¤šè§’è‰²åŒæ™‚é¡¯ç¤º

**å°è©±æ•ˆæœ**ï¼š
- æ–‡å­—é€å­—é¡¯ç¤º
- æ‰“å­—æ©Ÿæ•ˆæœ
- èªéŸ³é ç•™ï¼ˆå¯é¸ï¼‰
- å°è©±æ­·å²è¨˜éŒ„

---

## ç¬¬åä¸€éƒ¨åˆ†ï¼šæˆ°é¬¥ç³»çµ±ï¼ˆç°¡åŒ–ç‰ˆï¼‰

### 11.1 æˆ°é¬¥å ´æ™¯

**è§¸ç™¼æƒ…æ³**ï¼š
- å¤–å‡ºä»»å‹™é‡æ•µ
- å®¢æ£§ä¿è¡›æˆ°
- ç‰¹æ®ŠåŠ‡æƒ…æˆ°é¬¥

### 11.2 æˆ°é¬¥æ©Ÿåˆ¶ï¼ˆç°¡åŒ–ç‰ˆï¼‰

**å›åˆåˆ¶æµç¨‹**ï¼š
1. åˆå§‹åŒ–æˆ°é¬¥
2. è¨ˆç®—é€Ÿåº¦é †åº
3. è¡Œå‹•é¸æ“‡
4. åŸ·è¡Œå‹•ä½œ
5. åˆ¤å®šå‹è² 

**è¡Œå‹•é¸æ“‡**ï¼š
- æ”»æ“Šï¼šåŸºç¤å‚·å®³
- æŠ€èƒ½ï¼šæ¶ˆè€—èƒ½é‡
- é˜²ç¦¦ï¼šæ¸›å°‘å‚·å®³
- ç‰©å“ï¼šä½¿ç”¨é“å…·
- é€ƒè·‘ï¼šé›¢é–‹æˆ°é¬¥

**æ•¸å€¼è¨ˆç®—**ï¼š
```
å‚·å®³ = æ”»æ“Šæ–¹æ­¦åŠ› - é˜²ç¦¦æ–¹é«”è³ª/2 + éš¨æ©Ÿ(0-10)
å‘½ä¸­ç‡ = 80% + (æ”»æ“Šæ–¹éˆå·§ - é˜²ç¦¦æ–¹éˆå·§) / 10
æš´æ“Šç‡ = 5% + æ”»æ“Šæ–¹æ­¦åŠ› / 100
```

**å‹åˆ©çå‹µ**ï¼š
- é‡‘éŒ¢
- è£å‚™
- ç¶“é©—å€¼
- ä»»å‹™é€²åº¦

---

## ç¬¬åäºŒéƒ¨åˆ†ï¼šç³»çµ±äº¤äº’çŸ©é™£

| ç³»çµ±A | ç³»çµ±B | äº¤äº’æ–¹å¼ | å½±éŸ¿ |
|-------|-------|---------|------|
| TimeManager | InnManager | update() é©…å‹• | å®¢äººåˆ°é”ã€æœˆçµç®— |
| TimeManager | CharacterDispatchManager | æª¢æŸ¥å·¥ä½œæ™‚é–“ | å“¡å·¥ä¸Šä¸‹ç­ |
| InnManager | RecipeManager | è¨‚å–®å‰µå»º | çƒ¹é£ªä»»å‹™ |
| CharacterDispatchManager | RecipeManager | æŒ‡æ´¾çƒ¹é£ª | è£½ä½œæ–™ç† |
| AffectionManager | StoryManager | å¥½æ„Ÿåº¦åˆ¤å®š | è§¸ç™¼åŠ‡æƒ… |
| EventManager | TimeManager | ç›£è½æ™‚é–“äº‹ä»¶ | è§¸ç™¼éš¨æ©Ÿäº‹ä»¶ |
| MissionManager | CharacterDispatchManager | æ´¾é£å“¡å·¥ | å“¡å·¥å¤–å‡º |
| TechnologyManager | InnManager | å‡ç´šè¨­æ–½ | è§£é–æ–°åŠŸèƒ½ |

---

## ç¬¬åä¸‰éƒ¨åˆ†ï¼šæ•¸å€¼å¹³è¡¡

### 13.1 ç¶“æ¿Ÿå¹³è¡¡

**ç¬¬1å¹´**ï¼šç”Ÿå­˜æœŸ
- ç›®æ¨™ï¼šå­¸ç¿’éŠæˆ²æ©Ÿåˆ¶
- æ”¶å…¥ï¼šå‹‰å¼·ç¶­æŒ
- å“¡å·¥ï¼š2-3äºº
- è¨­æ–½ï¼šåŸºç¤è¨­æ–½

**ç¬¬2å¹´**ï¼šæˆé•·æœŸ
- ç›®æ¨™ï¼šç©©å®šç¶“ç‡Ÿ
- æ”¶å…¥ï¼šé–‹å§‹ç›ˆåˆ©
- å“¡å·¥ï¼š4-6äºº
- è¨­æ–½ï¼šå‡ç´š1-2å€‹

**ç¬¬3å¹´**ï¼šç™¼å±•æœŸ
- ç›®æ¨™ï¼šæ“´å¼µè¦æ¨¡
- æ”¶å…¥ï¼šé«˜é¡ç›ˆåˆ©
- å“¡å·¥ï¼š7-8äºº
- è¨­æ–½ï¼šå‡ç´š3-4å€‹

**ç¬¬4å¹´**ï¼šæˆç†ŸæœŸ
- ç›®æ¨™ï¼šè‡ªç”±ç™¼å±•
- æ”¶å…¥ï¼šè²¡å‹™è‡ªç”±
- å“¡å·¥ï¼š9-10äºº
- è¨­æ–½ï¼šå…¨éƒ¨è§£é–

### 13.2 é›£åº¦æ›²ç·š

**å‰æœŸï¼ˆ1-6æœˆï¼‰**ï¼š
- æ•™å­¸å¼•å°
- è¼ƒç°¡å–®
- å®¹éŒ¯ç‡é«˜

**ä¸­æœŸï¼ˆ7-18æœˆï¼‰**ï¼š
- æŒ‘æˆ°å¢åŠ 
- éœ€è¦ç­–ç•¥
- å¤šç¨®é¸æ“‡

**å¾ŒæœŸï¼ˆ19æœˆ+ï¼‰**ï¼š
- è‡ªç”±åº¦é«˜
- å¤šç¨®ç©æ³•
- è¿½æ±‚å®Œç¾

---

## ç¬¬åå››éƒ¨åˆ†ï¼šå¯¦ä½œæŒ‡å—

### 14.1 é–‹ç™¼å„ªå…ˆç´š

**P0ï¼ˆå·²å®Œæˆï¼‰**ï¼š
- âœ… æ™‚é–“ç³»çµ± (TimeManager)
- âœ… ç¶“ç‡Ÿç³»çµ± (InnManager)
- âœ… å“¡å·¥ç³»çµ± (CharacterDispatchManager)
- âœ… çƒ¹é£ªç³»çµ± (RecipeManager)

**P1ï¼ˆé€²è¡Œä¸­ï¼‰**ï¼š
- âœ… å¥½æ„Ÿåº¦ç³»çµ± (AffectionManager)
- âœ… åŠ‡æƒ…ç³»çµ± (StoryManager)
- âœ… äº‹ä»¶ç³»çµ± (EventManager)
- âœ… å­¸ç¿’ç³»çµ± (LearningManager)

**P2ï¼ˆå¾…å¯¦ä½œï¼‰**ï¼š
- â³ æˆ°é¬¥ç³»çµ± (CombatManager)
- â³ è²¿æ˜“ç³»çµ± (TradeManager)
- â³ æ´¾é£ç³»çµ± (MissionManager)

**P3ï¼ˆæœªä¾†ï¼‰**ï¼š
- â³ ç§‘æŠ€æ¨¹ç³»çµ± (TechnologyManager)
- â³ å­£ç¯€ç³»çµ± (SeasonManager)
- â³ æˆå°±ç³»çµ± (AchievementManager)

### 14.2 æ¸¬è©¦è¦é»

**ç¶“æ¿Ÿå¹³è¡¡æ¸¬è©¦**ï¼š
- æ”¶æ”¯å¹³è¡¡æ¸¬è©¦
- è–ªè³‡æ”¯ä»˜æ¸¬è©¦
- è¨­æ–½å‡ç´šæˆæœ¬æ¸¬è©¦

**å¥½æ„Ÿåº¦æˆé•·æ›²ç·šæ¸¬è©¦**ï¼š
- å¥½æ„Ÿåº¦å¢æ¸›æ¸¬è©¦
- é—œä¿‚ç­‰ç´šæ¸¬è©¦
- ç¦®ç‰©ç³»çµ±æ¸¬è©¦

**åŠ‡æƒ…è§¸ç™¼é‚è¼¯æ¸¬è©¦**ï¼š
- æ¢ä»¶æª¢æŸ¥æ¸¬è©¦
- åˆ†æ”¯è·³è½‰æ¸¬è©¦
- çå‹µç™¼æ”¾æ¸¬è©¦

**ç³»çµ±äº¤äº’æ¸¬è©¦**ï¼š
- æ™‚é–“é©…å‹•æ¸¬è©¦
- å ´æ™¯åˆ‡æ›æ¸¬è©¦
- æ•¸æ“šåŒæ­¥æ¸¬è©¦

### 14.3 æ€§èƒ½å„ªåŒ–

**æ•¸æ“šçµæ§‹å„ªåŒ–**ï¼š
- ä½¿ç”¨å°è±¡æ± ç®¡ç†ç²¾éˆ
- æ‡¶åŠ è¼‰å ´æ™¯è³‡æº
- å¿«å–è¨ˆç®—çµæœ

**æ¸²æŸ“å„ªåŒ–**ï¼š
- é›¢å±è£å‰ª
- æ‰¹æ¬¡æ¸²æŸ“
- ç´‹ç†å£“ç¸®

**è¨˜æ†¶é«”å„ªåŒ–**ï¼š
- åŠæ™‚é‡‹æ”¾è³‡æº
- é¿å…è¨˜æ†¶é«”æ´©æ¼
- å®šæœŸåƒåœ¾å›æ”¶

---

## ç¬¬åäº”éƒ¨åˆ†ï¼šè¦–è¦ºè³‡ç”¢éœ€æ±‚

### 15.1 å ´æ™¯èƒŒæ™¯

**å®¢æ£§å¤–è§€ï¼ˆå°è¦–çª—ï¼‰**ï¼š
- exterior_level_1.png (åˆæœŸï¼šç°¡é™‹å°å®¢æ£§)
- exterior_level_2.png (3å€‹å¤¥ä¼´ï¼šå¢åŠ æ‹›ç‰Œ)
- exterior_level_3.png (5å€‹å¤¥ä¼´ï¼šäºŒå±¤æ¨“)
- exterior_level_4.png (7å€‹å¤¥ä¼´ï¼šä¸‰å±¤æ¨“)
- exterior_level_5.png (10å€‹å¤¥ä¼´ï¼šè±ªè¯å®¢æ£§)

å°ºå¯¸ï¼š300x350
è¦–è§’ï¼šæ–œå‘45åº¦
é¢¨æ ¼ï¼š32-bit åƒç´ é¢¨æ ¼

**å®¢æ£§å…§éƒ¨å ´æ™¯**ï¼š
- lobby_interior.png (ä¸€æ¨“å¤§å»³)
- kitchen_interior.png (å»šæˆ¿)
- room_interior.png (å®¢æˆ¿å€)
- storage_interior.png (å„²è—å®¤)
- yard_interior.png (å¾Œé™¢)

å°ºå¯¸ï¼š900x550
è¦–è§’ï¼šæ–œå‘45åº¦
åŒ…å«ï¼šæ«ƒå°ã€æ¡Œæ¤…ã€æ¨“æ¢¯ç­‰å›ºå®šç‰©ä»¶

### 15.2 è§’è‰²ç²¾éˆåœ–

**æ¯å€‹è§’è‰²éœ€è¦**ï¼š
- character_name_idle.png (å¾…æ©Ÿå‹•ç•«ï¼Œ4å¹€)
- character_name_walk_down.png (å‘ä¸‹èµ°ï¼Œ4å¹€)
- character_name_walk_up.png (å‘ä¸Šèµ°ï¼Œ4å¹€)
- character_name_walk_left.png (å‘å·¦èµ°ï¼Œ4å¹€)
- character_name_walk_right.png (å‘å³èµ°ï¼Œ4å¹€)
- character_name_work.png (å·¥ä½œå‹•ç•«ï¼Œ4å¹€)

å°ºå¯¸ï¼š64x64 æ¯å¹€
æ•¸é‡ï¼š10å€‹è§’è‰² Ã— 6ç¨®å‹•ç•« = 60å€‹ç²¾éˆè¡¨

### 15.3 è§’è‰²ç«‹ç¹ª

**æ¯å€‹è§’è‰²éœ€è¦**ï¼š
- portrait_name_normal.png (æ™®é€šè¡¨æƒ…)
- portrait_name_happy.png (é–‹å¿ƒ)
- portrait_name_sad.png (é›£é)
- portrait_name_angry.png (ç”Ÿæ°£)
- portrait_name_surprised.png (é©šè¨)

å°ºå¯¸ï¼š512x768
æ•¸é‡ï¼š10å€‹è§’è‰² Ã— 5ç¨®è¡¨æƒ… = 50å¼µç«‹ç¹ª

### 15.4 UI åœ–æ¨™

**ç‹€æ…‹åœ–æ¨™**ï¼š
- status_working.png (å·¥ä½œä¸­)
- status_resting.png (ä¼‘æ¯ä¸­)
- status_sleeping.png (ç¡çœ ä¸­)
- status_mission.png (ä»»å‹™ä¸­)

**è³‡æºåœ–æ¨™**ï¼š
- icon_gold.png (é‡‘éŒ¢)
- icon_reputation.png (è²æœ›)
- icon_satisfaction.png (æ»¿æ„åº¦)
- icon_time.png (æ™‚é–“)

### 15.5 ä½”ä½åœ–æ–¹æ¡ˆ

åœ¨æ­£å¼ç´ æå®Œæˆå‰ï¼š
- èƒŒæ™¯ï¼šç´”è‰² + ç¶²æ ¼ç·š
- è§’è‰²ï¼šå¸¶åå­—çš„åœ“å½¢
- åœ–æ¨™ï¼šemoji æˆ–æ–‡å­—
- ç«‹ç¹ªï¼šç°¡å–®è‰²å¡Š

---

## é™„éŒ„ Aï¼šç³»çµ± API åƒè€ƒ

### TimeManager

```javascript
// æ™‚é–“æ§åˆ¶
timeManager.update(deltaTime)
timeManager.pauseTime()
timeManager.resumeTime()
timeManager.setTimeScale(scale)

// æ™‚é–“æŸ¥è©¢
timeManager.getCurrentTime()
timeManager.getTimePeriod()
timeManager.isBusinessHours()

// äº‹ä»¶ç›£è½
timeManager.onDayStart(callback)
timeManager.onMonthEnd(callback)
timeManager.onHourChange(callback)
```

### InnManager

```javascript
// ç¶“ç‡Ÿç®¡ç†
innManager.addGold(amount)
innManager.spendGold(amount)
innManager.updateReputation(value)
innManager.updateSatisfaction(value)

// è¨­æ–½ç®¡ç†
innManager.upgradeFacility(facilityId)
innManager.getFacilityLevel(facilityId)
innManager.canUpgrade(facilityId)
```

### CharacterDispatchManager

```javascript
// å·¥ä½œåˆ†é…
dispatchManager.assignWork(employeeId, stationId)
dispatchManager.unassignWork(employeeId)
dispatchManager.getWorkingEmployees()

// ç‹€æ…‹æŸ¥è©¢
dispatchManager.getEmployeeState(employeeId)
dispatchManager.calculateEfficiency(employeeId)
```

### AffectionManager

```javascript
// å¥½æ„Ÿåº¦ç®¡ç†
affectionManager.addAffection(employeeId, points, reason)
affectionManager.getAffectionLevel(employeeId)
affectionManager.getRelationship(employeeId)

// ç¦®ç‰©ç³»çµ±
affectionManager.giveGift(employeeId, giftId)
affectionManager.canGiveGift(employeeId)
```

---

## é™„éŒ„ Bï¼šæ•¸æ“šé…ç½®ç¤ºä¾‹

### èœè­œé…ç½®

```javascript
const RECIPES = {
    'rice_congee': {
        id: 'rice_congee',
        name: 'ç™½ç²¥',
        category: 'ä¸»é£Ÿ',
        difficulty: 1,
        cookTime: 10,
        ingredients: [
            { id: 'rice', quantity: 2 },
            { id: 'water', quantity: 5 }
        ],
        requiredSkill: 1,
        sellPrice: 5,
        reputation: 1,
        satisfaction: 10
    },

    'braised_pork': {
        id: 'braised_pork',
        name: 'ç´…ç‡’è‚‰',
        category: 'ç†±èœ',
        difficulty: 3,
        cookTime: 30,
        ingredients: [
            { id: 'pork', quantity: 5 },
            { id: 'soy_sauce', quantity: 2 },
            { id: 'sugar', quantity: 1 }
        ],
        requiredSkill: 5,
        sellPrice: 20,
        reputation: 5,
        satisfaction: 30
    }
};
```

### å“¡å·¥é…ç½®

```javascript
const EMPLOYEES = {
    0: {
        id: 0,
        name: 'æŒæ«ƒ',
        realName: 'æ²ˆé’å±±',
        type: 'manager',
        attributes: {
            physique: 50,
            strength: 60,
            intelligence: 80,
            charisma: 85,
            dexterity: 45
        },
        salary: 100,
        unlockCost: 0
    },

    1: {
        id: 1,
        name: 'å­Ÿå››å¨˜',
        realName: 'å­Ÿé›²å¨˜',
        type: 'chef',
        attributes: {
            physique: 60,
            strength: 50,
            intelligence: 65,
            charisma: 40,
            dexterity: 90
        },
        salary: 80,
        unlockCost: 500
    }
};
```

---

## é™„éŒ„ Cï¼šé–‹ç™¼æª¢æŸ¥æ¸…å–®

### æ ¸å¿ƒç³»çµ±
- [x] TimeManager å¯¦ä½œå®Œæˆ
- [x] InnManager å¯¦ä½œå®Œæˆ
- [x] CharacterDispatchManager å¯¦ä½œå®Œæˆ
- [x] RecipeManager å¯¦ä½œå®Œæˆ
- [x] AffectionManager å¯¦ä½œå®Œæˆ
- [x] StoryManager å¯¦ä½œå®Œæˆ
- [x] EventManager å¯¦ä½œå®Œæˆ
- [x] LearningManager å¯¦ä½œå®Œæˆ
- [ ] CombatManager å¯¦ä½œå®Œæˆ
- [ ] TradeManager å¯¦ä½œå®Œæˆ
- [ ] MissionManager å¯¦ä½œå®Œæˆ

### æ¸¬è©¦è¦†è“‹
- [x] æ™‚é–“ç³»çµ±æ¸¬è©¦
- [x] ç¶“ç‡Ÿç³»çµ±æ¸¬è©¦
- [x] å“¡å·¥ç³»çµ±æ¸¬è©¦
- [x] çƒ¹é£ªç³»çµ±æ¸¬è©¦
- [ ] å¥½æ„Ÿåº¦ç³»çµ±æ¸¬è©¦
- [ ] åŠ‡æƒ…ç³»çµ±æ¸¬è©¦
- [ ] äº‹ä»¶ç³»çµ±æ¸¬è©¦
- [ ] å­¸ç¿’ç³»çµ±æ¸¬è©¦

### å ´æ™¯å¯¦ä½œ
- [x] ExteriorScene å¯¦ä½œå®Œæˆ
- [x] LobbyScene å¯¦ä½œå®Œæˆ
- [ ] KitchenScene å¯¦ä½œå®Œæˆ
- [ ] StorageScene å¯¦ä½œå®Œæˆ
- [ ] RoomScene å¯¦ä½œå®Œæˆ
- [ ] YardScene å¯¦ä½œå®Œæˆ
- [ ] StoryScene å¯¦ä½œå®Œæˆ

### ç¾è¡“è³‡æº
- [ ] å®¢æ£§å¤–è§€ï¼ˆ5å€‹ç­‰ç´šï¼‰
- [ ] å ´æ™¯èƒŒæ™¯ï¼ˆ6å€‹å ´æ™¯ï¼‰
- [ ] è§’è‰²ç²¾éˆï¼ˆ10å€‹è§’è‰²ï¼‰
- [ ] è§’è‰²ç«‹ç¹ªï¼ˆ10å€‹è§’è‰² Ã— 5ç¨®è¡¨æƒ…ï¼‰
- [ ] UI åœ–æ¨™ï¼ˆ20+å€‹ï¼‰

### ç”¨æˆ¶æ¸¬è©¦
- [ ] ç¶“æ¿Ÿå¹³è¡¡æ¸¬è©¦
- [ ] é›£åº¦æ›²ç·šæ¸¬è©¦
- [ ] ç”¨æˆ¶é«”é©—æ¸¬è©¦
- [ ] æ€§èƒ½æ¸¬è©¦

---

**æ–‡æª”ç‰ˆæœ¬**: v2.0
**å‰µå»ºæ—¥æœŸ**: 2025-10-24
**æœ€å¾Œæ›´æ–°**: 2025-10-28
**ç¶­è­·è€…**: é–‹ç™¼åœ˜éšŠ
