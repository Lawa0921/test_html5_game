# 桌面冒險者 - 遊戲設計文檔

## 核心概念

一個運行在桌面上的透明視窗遊戲，角色們像桌寵一樣在你的桌面上活動。透過你的日常電腦操作（點擊、打字）來獲得銀兩，並用銀兩培養你的冒險隊伍。

---

## 遊戲循環

```
玩家操作（點擊/打字）
    ↓
獲得銀兩
    ↓
投資（家園/裝備/寵物）
    ↓
角色變強
    ↓
銀兩獲得速度提升
    ↓
解鎖新角色
    ↓
觸發隨機事件
    ↓
探索角色背景故事
```

---

## 核心系統設計

### 1. 銀兩系統

#### 獲取方式
- **被動收入**：
  - 每次滑鼠點擊：+1 銀兩（基礎值）
  - 每次鍵盤按鍵：+1 銀兩（基礎值）
  - 角色自動探險：每秒 +N 銀兩

- **主動收入**：
  - 完成隨機事件
  - 擊敗山賊
  - 發現寶藏

#### 增益機制
基礎收入會隨著投資而增加：
```
點擊收入 = 基礎值(1) × 裝備加成 × 家園加成 × 寵物加成
```

---

### 2. 角色系統

#### 角色列表（10 位）
0. **主角**（預設解鎖）
1. **法師** - 解鎖條件：銀兩達到 1,000
2. **弓箭手** - 解鎖條件：完成第一個地下城
3. **盜賊** - 解鎖條件：觸發寶藏事件
4. **牧師** - 解鎖條件：主角達到 Lv.20
5. **戰士** - 解鎖條件：擊退 10 次山賊
6. **刺客** - 解鎖條件：銀兩達到 10,000
7. **德魯伊** - 解鎖條件：購買第一隻寵物
8. **武僧** - 解鎖條件：完成 5 個背景故事事件
9. **騎士** - 解鎖條件：家園等級達到 5 級

#### 角色屬性
```javascript
{
  id: 0,
  name: "主角",
  level: 1,          // 1-200
  exp: 0,
  maxExp: 100,

  // 基礎屬性
  attack: 10,
  defense: 5,
  hp: 100,
  maxHp: 100,

  // 裝備
  weapon: null,
  armor: null,
  accessory: null,

  // 狀態
  status: 'idle',    // idle, walking, attacking, resting
  unlocked: true,

  // 背景故事進度
  storyProgress: 0,  // 已完成的故事事件數

  // 位置（桌面座標）
  x: 100,
  y: 100
}
```

---

### 3. 升級系統

#### 經驗值獲取
- 完成事件：+100 exp
- 擊敗山賊：+50 exp
- 探索地下城：+200 exp
- 自動探險：每分鐘 +10 exp

#### 升級公式
```javascript
// 每級所需經驗
requiredExp(level) = 100 * Math.pow(1.1, level - 1)

// 升級時屬性成長
onLevelUp(character) {
  character.attack += 2
  character.defense += 1
  character.maxHp += 10
  character.hp = character.maxHp
}
```

---

### 4. 家園系統

#### 等級與效果
| 等級 | 名稱 | 升級費用 | 銀兩加成 | 解鎖內容 |
|-----|------|---------|---------|---------|
| 1 | 簡陋小屋 | - | +0% | 基礎功能 |
| 2 | 木屋 | 500 | +10% | 裝備系統 |
| 3 | 石屋 | 2,000 | +25% | 寵物系統 |
| 4 | 大宅 | 5,000 | +50% | 第二隻寵物 |
| 5 | 豪宅 | 10,000 | +100% | 解鎖騎士 |
| 6 | 城堡 | 50,000 | +200% | 全部功能 |

---

### 5. 裝備系統

#### 裝備類型
- **武器**：增加攻擊力，影響銀兩獲取速度
- **防具**：增加防禦力，減少事件中的損失
- **飾品**：特殊效果（暴擊、經驗加成等）

#### 品質等級
- 普通（白色）：+10% 屬性
- 優秀（綠色）：+25% 屬性
- 稀有（藍色）：+50% 屬性
- 史詩（紫色）：+100% 屬性
- 傳說（橙色）：+200% 屬性

---

### 6. 寵物系統

#### 寵物功能
- **被動收入**：每隻寵物每秒產生銀兩
- **屬性加成**：給主人加屬性
- **技能**：特殊能力（例如：自動收集掉落物）

#### 寵物狀態
- **飢餓值**：0-100，每小時 -10
- **飼料**：恢復飢餓值，花費銀兩購買
- **飢餓懲罰**：飢餓值 < 20 時效果減半

---

### 7. 隨機事件系統

#### 事件類型

**1. 地下城探險**
- 觸發條件：隨機（平均每 10 分鐘）
- 選擇角色組隊（1-3 人）
- 消耗體力，獲得經驗和銀兩
- 可能掉落裝備

**2. 寶藏發現**
- 觸發條件：隨機（平均每 15 分鐘）
- 點擊開啟
- 獲得大量銀兩或稀有裝備

**3. 山賊襲擊**
- 觸發條件：隨機（平均每 20 分鐘）
- 自動戰鬥
- 勝利：獲得獎勵
- 失敗：損失少量銀兩

**4. 背景故事事件**
- 觸發條件：角色達到特定等級
- 多選對話
- 解鎖角色背景故事片段
- 獲得特殊獎勵或角色專屬裝備

---

### 8. 全局輸入監聽

#### 監聽範圍
- **選項 A（完整體驗）**：監聽全局輸入
  - 需要權限
  - 可能被防毒軟體標記
  - 體驗最好

- **選項 B（安全）**：只監聽遊戲視窗
  - 無需特殊權限
  - 需要遊戲視窗保持焦點
  - 較安全

#### 實作方式（選項 B）
```javascript
// Electron 主進程
const { uIOhook } = require('uiohook-napi')

uIOhook.on('click', () => {
  // 通知渲染進程獲得銀兩
})

uIOhook.on('keydown', () => {
  // 通知渲染進程獲得銀兩
})

uIOhook.start()
```

---

## UI 設計

### 主介面元素

1. **角色顯示區**（桌面上）
   - 角色小模型在桌面四處移動
   - 待機動畫
   - 點擊角色顯示資訊

2. **銀兩顯示**（桌面頂部）
   - 半透明背景
   - 即時更新
   - 點擊特效

3. **快捷選單**（右鍵或快捷鍵）
   - 角色管理
   - 家園升級
   - 裝備商店
   - 寵物商店
   - 設定

4. **事件彈窗**
   - 全螢幕遮罩 + 中央彈窗
   - 事件描述
   - 選擇按鈕

---

## 數據持久化

### 存檔內容
```javascript
{
  // 遊戲進度
  totalClicks: 0,
  totalKeyPress: 0,
  silver: 0,
  playTime: 0,
  lastSaveTime: timestamp,

  // 家園
  homeLevel: 1,

  // 角色
  characters: [...],

  // 裝備
  equipment: [...],
  inventory: [...],

  // 寵物
  pets: [...],

  // 事件紀錄
  eventHistory: [...],

  // 成就
  achievements: [...]
}
```

### 自動存檔
- 每 30 秒自動存檔
- 關閉視窗時存檔
- 使用 localStorage

---

## 平衡性設計

### 遊戲節奏

**前 10 分鐘**：
- 熟悉點擊機制
- 獲得第一個 1000 銀兩
- 解鎖第一個同伴（法師）

**1 小時內**：
- 主角達到 Lv.10
- 家園升到 Lv.2
- 解鎖 2-3 個同伴
- 購買第一件裝備

**長期目標**：
- 所有角色達到 Lv.200
- 家園滿級
- 收集全套傳說裝備
- 解鎖所有背景故事

---

## 技術架構

### 目錄結構
```
src/
├── core/
│   ├── GameState.js          # 遊戲狀態管理
│   ├── Character.js          # 角色邏輯
│   ├── Economy.js            # 經濟系統
│   ├── Equipment.js          # 裝備系統
│   ├── Pet.js               # 寵物系統
│   └── EventManager.js       # 事件管理
│
├── scenes/
│   ├── DesktopScene.js       # 桌面主場景
│   ├── EventScene.js         # 事件彈窗場景
│   └── MenuScene.js          # 選單場景
│
├── ui/
│   ├── SilverDisplay.js      # 銀兩顯示
│   ├── CharacterPanel.js     # 角色面板
│   └── ShopPanel.js          # 商店面板
│
└── utils/
    ├── InputListener.js      # 輸入監聽
    └── SaveManager.js        # 存檔管理
```

---

## 下一步開發順序

1. ✅ 規劃設計文檔
2. 🔄 實作透明 Electron 視窗
3. 實作銀兩系統（點擊計數）
4. 實作角色系統（主角 + 解鎖機制）
5. 實作家園系統
6. 實作隨機事件
7. 完善 UI
8. 添加音效
9. 優化與測試
